#!/bin/bash
#
# vim:ft=sh

############### Variables ###############

############### Functions ###############

############### Main Part ###############

IF=$WG_INTERFACE

[ $1 ] && IF=dante.$WG_INTERFACE

# systemctl edit wg-quick@$IF and add:
# [Service]
# ExecStartPre=bash -c "/usr/bin/sed -i /Endpoint/s:..$:$(date +%%d): /etc/wireguard/%i.conf"
# or do it here
# sudo sed -i /Endpoint/s/..$/$(date +%d)/ /etc/wireguard/$IF.conf

# set Conflicts in systemd unit in one of them is enough
# [Unit]
# Conflicts=wg-quick@z.service
# After=network-online.target nss-lookup.target wg-quick@z.service
sudo systemctl restart wg-quick@$IF

wg show
